document.addEventListener("DOMContentLoaded",function(){window.newsTranslations;let s={currentPage:1,perPage:12,sortBy:"relevance",searchQuery:"",startDate:"",endDate:"",view:"grid",currentLanguage:document.documentElement.lang||"en"};function e(){var e=new URLSearchParams(window.location.search);s.sortBy=e.get("sort_by")||"relevance",s.perPage=parseInt(e.get("per_page")||"12"),s.currentPage=parseInt(e.get("page")||"1"),s.searchQuery=e.get("search")||"",s.startDate=e.get("from_date")||"",s.endDate=e.get("to_date")||"",s.searchQuery&&r.searchInput&&(r.searchInput.value=s.searchQuery),s.sortBy&&n(document.querySelector(".sort-by-select"),s.sortBy),s.perPage&&n(document.querySelector(".per-page-select"),s.perPage.toString()),s.startDate&&r.startDateInput&&(r.startDateInput.value=s.startDate),s.endDate&&r.endDateInput&&(r.endDateInput.value=s.endDate)}function n(e,a){if(e){let n=e.querySelector(".custom-select"),r=e.querySelectorAll(".custom-option");n&&r.forEach(e=>{var t=e.getAttribute("data-value");t&&t.toLowerCase()===a.toLowerCase()&&((t=e.querySelector("span"))&&(n.textContent=t.textContent.trim()),r.forEach(e=>e.classList.remove("selected")),e.classList.add("selected"))})}}let r={searchInput:document.querySelector(".search-input"),searchButton:document.querySelector(".search-button"),gridViewBtn:document.querySelector(".grid-view"),listViewBtn:document.querySelector(".list-view"),newsContent:document.getElementById("newsContent"),newsGrid:document.querySelector(".news-grid"),newsList:document.querySelector(".news-list"),filterSortButton:document.querySelector(".filter-sort-button"),modalOverlay:document.getElementById("filterSortModalOverlay"),filterForm:document.getElementById("filter-form-news"),clearAllButton:document.querySelector(".btn-clear"),paginationContainer:document.querySelector(".pagination-container"),paginationInfo:document.querySelector(".pagination-info"),pagination:document.querySelector(".pagination"),startDateInput:document.getElementById("datepicker3"),endDateInput:document.getElementById("datepicker4"),viewResultBtn:document.querySelector(".btn-view")};function t(r){if(r){var e=r.querySelector(".custom-select"),a=r.querySelector(".custom-options"),o=r.querySelectorAll(".custom-option");if(e&&a&&o){let t=e.cloneNode(!0),n=(e.parentNode.replaceChild(t,e),t.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),document.querySelectorAll(".custom-select").forEach(e=>{e!==t&&e.classList.remove("open")}),this.classList.toggle("open")}),a.cloneNode(!1));o.forEach(function(e){e=e.cloneNode(!0);e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();e=this.querySelector("span"),e&&(t.textContent=e.textContent.trim()),e=this.getAttribute("data-value");console.log("Custom select changed to: "+e),r.classList.contains("sort-by-select")?s.sortBy=e:r.classList.contains("per-page-select")&&(s.perPage=parseInt(e)),r.querySelectorAll(".custom-option").forEach(e=>e.classList.remove("selected")),this.classList.add("selected"),t.classList.remove("open")}),n.appendChild(e)}),a.parentNode.replaceChild(n,a)}}}function a(){document.querySelectorAll(".custom-select-wrapper").forEach(t),document.addEventListener("click",function(e){e.target.closest(".custom-select-wrapper")||document.querySelectorAll(".custom-select").forEach(e=>{e.classList.remove("open")})})}function o(){var e;console.log("Applying filters with state:",s),e=new URLSearchParams,s.searchQuery&&e.set("search",s.searchQuery),e.set("sort_by",s.sortBy),e.set("per_page",s.perPage.toString()),1<s.currentPage&&e.set("page",s.currentPage.toString()),s.startDate&&e.set("from_date",s.startDate),s.endDate&&e.set("to_date",s.endDate),e=window.location.pathname+(e.toString()?"?"+e.toString():""),window.location.href=e}function c(){r.modalOverlay&&(r.modalOverlay.style.display="none")}function l(){var e,t;r.filterSortButton&&r.modalOverlay&&(r.filterSortButton.addEventListener("click",function(){n(document.querySelector(".sort-by-select"),s.sortBy),n(document.querySelector(".per-page-select"),s.perPage.toString()),r.startDateInput&&(r.startDateInput.value=s.startDate),r.endDateInput&&(r.endDateInput.value=s.endDate),r.modalOverlay.style.display="flex",a()}),r.modalOverlay.addEventListener("click",function(e){e.target===r.modalOverlay&&c()}),document.addEventListener("keydown",function(e){"Escape"===e.key&&"flex"===r.modalOverlay.style.display&&c()}),(e=document.querySelector(".filter-sort-modal"))&&e.addEventListener("click",function(e){e.stopPropagation()}),(e=document.querySelector(".btn-view"))&&(t=e.cloneNode(!0),e.parentNode.replaceChild(t,e),r.viewResultBtn=t,r.viewResultBtn.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),console.log("View Result button clicked");var e=document.querySelector(".sort-by-select"),e=(e&&(e=e.querySelector(".custom-option.selected"))&&(s.sortBy=e.getAttribute("data-value")),document.querySelector(".per-page-select"));e&&(e=e.querySelector(".custom-option.selected"))&&(s.perPage=parseInt(e.getAttribute("data-value"))),r.startDateInput&&(s.startDate=r.startDateInput.value.trim()),r.endDateInput&&(s.endDate=r.endDateInput.value.trim()),s.currentPage=1,console.log("Applying filters with values:",{sortBy:s.sortBy,perPage:s.perPage,startDate:s.startDate,endDate:s.endDate,searchQuery:s.searchQuery}),o(),c()})),e=document.querySelector(".btn-clear"))&&(t=e.cloneNode(!0),e.parentNode.replaceChild(t,e),r.clearAllButton=t,r.clearAllButton.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),console.log("Clear All button clicked"),r.filterForm&&r.filterForm.reset(),document.querySelectorAll(".custom-select-wrapper").forEach(e=>{var t,n=e.querySelector(".custom-select"),e=e.querySelectorAll(".custom-option"),r=e[0];n&&r&&((t=r.querySelector("span"))&&(n.textContent=t.textContent.trim()),e.forEach(e=>e.classList.remove("selected")),r.classList.add("selected"))}),r.startDateInput&&(r.startDateInput.value=""),r.endDateInput&&(r.endDateInput.value=""),r.searchInput&&(r.searchInput.value=""),s.startDate="",s.endDate="",s.sortBy="relevance",s.perPage=12,s.searchQuery="",s.currentPage=1,console.log("State reset to:",s),o(),c()}))}var i;window.clearDateFilter=function(e){e&&(e.preventDefault(),e.stopPropagation());var e=e.target.closest(".date-input");return e&&(e=e.querySelector("input"))&&(e.value="","datepicker3"===e.id?s.startDate="":"datepicker4"===e.id&&(s.endDate=""),e._flatpickr)&&e._flatpickr.clear(),console.log("Date filter cleared"),!1},console.log("Initializing news page JavaScript"),s.currentLanguage=document.documentElement.lang||"en",e(),a(),r.gridViewBtn&&r.listViewBtn&&(r.gridViewBtn.addEventListener("click",function(){s.view="grid",r.gridViewBtn.classList.add("active"),r.listViewBtn.classList.remove("active"),r.newsGrid&&r.newsList&&(r.newsGrid.style.display="grid",r.newsList.style.display="none"),r.newsContent&&(r.newsContent.classList.add("grid-view-active"),r.newsContent.classList.remove("list-view-active"))}),r.listViewBtn.addEventListener("click",function(){s.view="list",r.listViewBtn.classList.add("active"),r.gridViewBtn.classList.remove("active"),r.newsGrid&&r.newsList&&(r.newsList.style.display="flex",r.newsGrid.style.display="none"),r.newsContent&&(r.newsContent.classList.add("list-view-active"),r.newsContent.classList.remove("grid-view-active"))})),r.searchButton&&r.searchInput&&(r.searchButton.addEventListener("click",function(){s.searchQuery=r.searchInput.value.trim(),s.currentPage=1,console.log("Search button clicked with query:",s.searchQuery),o()}),r.searchInput.addEventListener("keypress",function(e){"Enter"===e.key&&(e.preventDefault(),s.searchQuery=r.searchInput.value.trim(),s.currentPage=1,console.log("Search enter pressed with query:",s.searchQuery),o())})),l(),"undefined"!=typeof flatpickr&&(i={dateFormat:"d.m.Y",allowInput:!0,locale:"ru"===s.currentLanguage?"ru":"default",onChange:function(e,t,n){n.element&&("datepicker3"===(n=n.element.id)?(s.startDate=t,console.log("Start date changed to:",t)):"datepicker4"===n&&(s.endDate=t,console.log("End date changed to:",t)))}},r.startDateInput&&flatpickr(r.startDateInput,i),r.endDateInput)&&flatpickr(r.endDateInput,i),r.newsGrid&&r.newsList&&(r.newsGrid.style.display="grid",r.newsList.style.display="none"),console.log("News page initialized with state:",s)});